(function(e){function t(t){for(var o,s,a=t[0],c=t[1],d=t[2],h=0,u=[];h<a.length;h++)s=a[h],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&u.push(r[s][0]),r[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);l&&l(t);while(u.length)u.shift()();return n.push.apply(n,d||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],o=!0,a=1;a<i.length;a++){var c=i[a];0!==r[c]&&(o=!1)}o&&(n.splice(t--,1),e=s(s.s=i[0]))}return e}var o={},r={app:0},n=[];function s(t){if(o[t])return o[t].exports;var i=o[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=o,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(i,o,function(t){return e[t]}.bind(null,o));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var d=0;d<a.length;d++)t(a[d]);var l=c;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"0cea":function(e,t,i){},"53a8":function(e,t,i){"use strict";i("0cea")},"56d7":function(e,t,i){"use strict";i.r(t);var o=i("2b0e"),r=i("8336"),n=i("132d"),s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("Adsense",{staticStyle:{height:"0"},attrs:{"data-ad-client":"ca-pub-7023023584987784","data-ad-slot":"5070366491"}}),t("div",[t("div",[t("form",[t("vue-webrtc",{ref:"webrtc",staticClass:"w-full video-webrtc",attrs:{id:"call-canvas",roomId:e.roomId,width:"100%"},on:{"share-started":e.shareStarted,"share-stopped":e.leftRoom,"left-room":e.leftRoom,"joined-room":e.joinedRoom}}),e.hasJoined?t("div",{staticClass:"video-webrtc-controls"},[t(r["a"],{staticClass:"mx-2 bg-primary",attrs:{size:"x-large"},on:{click:e.onHandleVideoOn}},[t(n["a"],[e._v(e._s(e.videoOn?"mdi-video-outline":"mdi-video-off-outline")+" ")])],1),t(r["a"],{staticClass:"mx-2 bg-primary",attrs:{size:"x-large"},on:{click:e.onHandleMicOn}},[t(n["a"],[e._v(e._s(e.micOn?"mdi-microphone":"mdi-microphone-off")+" ")])],1),t(r["a"],{staticClass:"mx-2 bg-red",attrs:{size:"x-large"},on:{click:e.toggleRoom}},[t(n["a"],[e._v("mdi-phone-hangup")])],1)],1):e._e()],1)])])],1)},a=[],c=i("cee4"),d=i("daa8"),l={name:"App",data(){return{el:Object(o["ref"])(null),roomId:"roomId",hasJoined:!1,videoOn:!0,micOn:!0,mediaRecorder:{},chunks:[],userStream:{},socket:Object(d["a"])("https://livestream-backend-ng53ixt7xq-as.a.run.app"),audioContext:null,videoContainer:null,stream:null}},mounted(){this.audioContext=new window.AudioContext,setTimeout(this.startListening(),1e3);const e=window.location.hash;""!=e&&(this.roomId=e.substring(1),this.toggleRoom())},methods:{async onStop(){var e=new Blob(this.chunks,{type:"video/webm"});this.chunks=[];const t=new File([e],this.roomId+".webm",{type:"video/webm"});console.log("data 1: ",t);let i=new FormData;i.append("fileName",""+this.roomId),i.append("file",t);const{data:o}=await c["a"].post("https://livestream-backend-ng53ixt7xq-as.a.run.app/files",i);console.log("data: ",o,i)},pushData(e){this.chunks.push(e.data)},record(){this.mediaRecorder.start()},onHandleVideoOn(){this.videoOn=!this.videoOn,this.userStream=this.$refs.webrtc.videoList[0].stream,this.userStream.video=this.videoOn,this.userStream.getVideoTracks()[0].enabled=this.videoOn},onHandleMicOn(){this.micOn=!this.micOn,console.log("this.micOn: ",this.micOn),this.userStream=this.$refs.webrtc.videoList[0].stream,this.userStream.audio=this.micOn,this.userStream.getAudioTracks()[0].enabled=this.micOn,this.micOn?this.startListening():this.stopListening()},stopListening(){this.mediaStreamSource&&(this.mediaStreamSource.disconnect(),this.mediaStreamSource=null,this.analyser=null,this.isListening=!1),setTimeout((function(){this.videoContainer=document.querySelector(".video-item video"),this.videoContainer.style.border="none"}),1e3)},startListening(){const e=this.$refs.webrtc.videoList[0].stream;console.log("stream ing: ",e),navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{this.stream=t,console.log("stream: ",this.stream,e),this.mediaStreamSource=this.audioContext.createMediaStreamSource(e),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=32,this.mediaStreamSource.connect(this.analyser),this.isListening=!0,this.checkTalking()}).catch(e=>{console.error("Error accessing microphone:",e)})},checkTalking(){const e=this.analyser.frequencyBinCount,t=new Uint8Array(e),i=()=>{if(!this.isListening)return;this.analyser.getByteFrequencyData(t);const o=t.reduce((e,t)=>e+t,0)/e,r=100;setTimeout((function(){console.log("stream ---: ",this.stream),this.videoContainer=document.querySelector(".video-item video"),o>r&&this.videoContainer?(this.videoContainer.style.border="thick solid #FF6B35",console.log("User is talking",this.analyser)):(this.videoContainer&&(this.videoContainer.style.border="none"),console.log("User is not talking",this.analyser))}),1e3),requestAnimationFrame(i)};i()},async toggleRoom(){try{this.hasJoined?(this.$refs.webrtc.leave(),this.hasJoined=!1,this.stopListening(),this.mediaRecorder.stop()):(await this.$refs.webrtc.join(),this.socket.emit("join",{sessionId:this.roomId}),this.userStream=this.$refs.webrtc.videoList[0].stream,this.mediaRecorder=new MediaRecorder(this.userStream),this.mediaRecorder.start(),this.mediaRecorder.ondataavailable=e=>this.pushData(e),this.mediaRecorder.onstop=()=>this.onStop(),this.hasJoined=!0)}catch(e){alert(e)}},screenShare(){try{this.$refs.webrtc.shareScreen()}catch(e){alert("Screen share not available")}},async addTrack(){try{const e=this.$refs.webrtc.videoList;e.forEach(e=>{this.userStream.addTrack(e)})}catch(e){alert(e)}},joinedRoom(e){console.log(e)},shareStarted(e){console.log(e)},leftRoom(e){console.log(e)},async copyClipboard(){const e=window.location.origin;await navigator.clipboard.writeText(`${e}/#${this.roomId}`),alert("Link copied to clipboard!")},async share(){const e=window.location.origin,t={title:"Vere-ai",text:"Join my meeting!",url:`${e}/#${this.roomId}`};try{await navigator.share(t)}catch(i){this.copyClipboard()}}}},h=l,u=(i("53a8"),i("2877")),m=Object(u["a"])(h,s,a,!1,null,null,null),p=m.exports,f=i("6293"),v=i.n(f),g=i("119b"),b=(i("a766"),i("f309"));i("5363");o["default"].use(b["a"]);const y={dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF",primary:"#3F372E","primary-darken-1":"#141414",secondary:"#03DAC6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"}};var w=new b["a"]({theme:{defaultTheme:"myCustomLightTheme",themes:{myCustomLightTheme:y}},defaults:{VBtn:{color:"primary",variant:"outlined",rounded:!0}},icons:{iconfont:"mdi"}}),S=i("ce5b"),O=i.n(S);i("bf40");o["default"].use(i("395c")),o["default"].use(O.a),o["default"].use(g["a"].Adsense),o["default"].use(v.a),o["default"].config.productionTip=!1,new o["default"]({vuetify:w,render:e=>e(p)}).$mount("#app")},a766:function(e,t,i){}});
//# sourceMappingURL=app.0d24601f.js.map